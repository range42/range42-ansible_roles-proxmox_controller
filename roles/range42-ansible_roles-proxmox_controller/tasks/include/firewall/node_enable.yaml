---
##
## #PR-32
##

- block:
    ####
    ####

    - name: FIREWALL - NODE  - ENABLE FIREWALL
      uri:
        url: "https://{{ proxmox_api_host }}/api2/json/nodes/{{ proxmox_node }}/firewall/options"
        method: PUT
        headers:
          Authorization: "PVEAPIToken={{ proxmox_api_user }}!{{ proxmox_api_token_id }}={{ proxmox_api_token_secret }}"
        body_format: json
        body:
          enable: 1
        validate_certs: no
      register: proxmox_call

    - name: PRINT proxmox_call
      debug:
        var: proxmox_call

    ####
    ####
    - name: FIREWALL - NODE - ENABLE - BUILD JSON
      set_fact:
        firewall_node_enable:
          action: "firewall_node_enable"
          source: "proxmox"
          proxmox_node: "{{ proxmox_node }}"
          #
          node_firewall: "enabled"

    - name: FIREWALL - NODE - ENABLE - PRINT JSON
      debug:
        var: firewall_node_enable

  when: proxmox_vm_action == "firewall_node_enable"
